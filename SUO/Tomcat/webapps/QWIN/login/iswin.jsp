<%@ page language="java" import="javax.servlet.http.*,javax.servlet.*,java.text.SimpleDateFormat.*,java.util.Calendar,java.text.ParseException,java.net.*,java.util.List,webwork.action.ActionContext,java.util.Date,java.util.Iterator,java.io.*,java.sql.*,webwork.action.ActionSupport,webwork.action.ActionSupport" %><% Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver").newInstance();  String connectionUrl = "jdbc:sqlserver://127.0.0.1;" + "databaseName=Qwin;user=qmatic;password=qmatic;";  String result;  Connection conn = DriverManager.getConnection(connectionUrl);  ResultSet rs = null;  Statement stmt = null;  stmt = conn.createStatement();   rs = stmt.executeQuery("SELECT *  FROM is_windows where ip='"+request.getRemoteAddr()+"'; ");          try {  		rs.next();  		if(rs.getRow()>0) {  			if(rs.getString(3).equals("0")) {  				result="0";  			} else {  				result=rs.getString(3);  			};             } else {  				result="0";  				rs = stmt.executeQuery("select top 1 * from is_windows; INSERT INTO is_windows(ip) VALUES ('"+request.getRemoteAddr()+"'); ");  		   };          } catch (SQLException e) {  			result="null";          }  		 %><%=result %>