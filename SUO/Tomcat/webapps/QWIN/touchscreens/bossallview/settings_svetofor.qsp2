 
<html>
    <head>
        <title>Общие настройки</title>
        <LINK REL="StyleSheet" HREF="style.css" TYPE="text/css">
		<LINK REL="StyleSheet" HREF="style_messages.css" TYPE="text/css">
		<script type="text/javascript" src="/lib/ajax.js"></script>  		
		<script language='javascript'>
function PrintPage(val, ObjName)
{
 var PrintedDiv;
 PrintedDiv = document.getElementById(ObjName);
 PrintedDiv.innerHTML = '';
 AddHTMLAjax(PrintedDiv,val);
}
function DoScript(href)
{
 var PrintedDiv;
 PrintedDiv = document.getElementById("DopElement");
PrintedDiv.innerHTML = '';
 AddHTMLAjax(PrintedDiv,href);

} 	
function close_salert(el)
{
var elem = parent.frames[0].document.getElementById('blockres');
elem.innerHTML=elem.innerHTML*1-1;
if(el==2) elem.innerHTML=0;
var messages = elem.innerHTML*1;
if(messages<0)
	{
	messages=0;
	elem.innerHTML=0;
	}
if(messages==0)
	parent.frames[0].document.getElementById('block').style.display = 'none';
parent.frames[1].document.getElementById('message_box_'+el+'_text').innerHTML="";
if(el==1)
	parent.frames[1].document.getElementById('message_box_3_text').innerHTML="";
}	

function createXMLHttpRequest() {
  try { return new XMLHttpRequest(); } catch(e) {}
  try { return new ActiveXObject('Msxml2.XMLHTTP'); } catch (e) {}
  try { return new ActiveXObject('Microsoft.XMLHTTP'); } catch (e) {}
  throw 'XMLHttpRequest not supported';
}

var HTTP_TIMEOUT = 10; // default to 20s
function httpRequest(url, onSuccess, onFail, postData, timeout) {

	var req = createXMLHttpRequest();
  var method = postData ? 'POST' : 'GET';
  req.open(method, url, true);
  req.setRequestHeader('User-Agent', 'XMLHTTP/1.0');
  if (postData) {
    req.setRequestHeader('Content-type','application/x-www-form-urlencoded');
  }

  var timer = null;
  if (!timeout) timeout = HTTP_TIMEOUT;
  if (timeout != -1) {
    timer = setTimeout(httpTimeoutClosure(req, onFail), timeout);
  }

  req.onreadystatechange = httpStatusChangeClosure(req, onSuccess, onFail, timer);
    req.send(postData);
}
  
function httpTimeoutClosure(req, onFail) {
  return function() {
   req.onreadystatechange = null;
    try {req.abort()}
   finally {if (onFail) onFail(req)}
  }
}

function httpStatusChangeClosure(req, onSuccess, onFail, timer) {
  return function() {
    if (req.readyState != 4) return;
    if (timer) clearTimeout(timer);
    if (req.status != 200 && req.status != 304) {
      if (onFail) onFail(req);
      return;
    }    
    if (onSuccess) onSuccess(req);
  }
}





function getVarValueFromURL(url, varName) { //для получение значений из URL
	var query = url.substring(url.indexOf('?') + 1);
	var vars = query.split("&");
	for (var i=0;i<vars.length;i++) {
		var pair = vars[i].split("=");
		if (pair[0] == varName) {
			return pair[1];
		}
	}
	return null;
} ;
function test_change() {
if(getVarValueFromURL(document.URL ,'change') == '1') {
httpRequest('/ca/update/set_suo_to_db.jsp', function(req) { }, function(req) {}, null, 3000);

};
};
		</script>
    </head><body onload="test_change()">
<form method="GET" name="workstationInfo"><input type="HIDDEN" name="change" value="1" size="7">
<input type="hidden" name="saveData" value="true">
  <div id="DopElement"></div>
 <%
 A=(${green_time}0)/10
 IF(A GT 0)
 SETARRAY(490 (A*60))
 A=(${yellow_time}0)/10
 IF(A GT 0)
 SETARRAY(490 (A*60))
 A=(${red_time}0)/10
 IF(A GT 0) BEGIN
 SETARRAY(492 (A*60))
 SETARRAY(491 (A*60))
 END
 A=(${green_time_ws}0)/10
 IF(A GT 0)
 SETARRAY(493 (A*60))
 A=(${yellow_time_ws}0)/10
 IF(A GT 0)
 SETARRAY(494 (A*60))
 A=(${red_time_ws}0)/10
 IF(A GT 0)
 SETARRAY(495 (A*60))
 %>
<table class=tableMain cellpadding=5 cellspacing=0>
	<tr>
		<td class=headerBar align=left colspan=2>
			Настройки светофора
		</td>
	</tr>
	<tr>
		<td colspan=2>
			<table class=tableSection cellpadding=0 cellspacing=0>
				<tr>
					<td nowrap class=tdHeaderSection>Время ожидания клиентов</td>
					<td nowrap class=tdHeaderSection colspan=2>Значение</td>
				</tr>
 
				
						
				<tr>
					<td nowrap class=tdDataRow>желтой тактики</td>
					<td><img src=yellow.png width=20>&nbsp;</td>
					<td nowrap class=tdDataRowC><input type="input" name="yellow_time" id="yellow_time" value="<% ARRAY(490) %>" size="7"></td>
					<td nowrap class=tdDataRowL>секунд</td>
				</tr>
 			<tr>
					<td nowrap class=tdDataRow>красной тактики</td>
					<td><img src=red.png width=20>&nbsp;&nbsp;&nbsp;</td><td nowrap class=tdDataRowC><input type="input" name="red_time" id="red_time" value="<% ARRAY(491) %>" size="7"></td>
					<td nowrap class=tdDataRowL>секунд</td>
				</tr>
				
					
						<script type='text/javascript'>
							var DopCom = "";
							el = document.getElementById('green_time');

		
							val = el.value;
							DopCom += el.id + "=" + el.value+ "_";
							el = document.getElementById('yellow_time');
							val = el.value;
							DopCom += el.id + "=" + el.value+ "_";
							el = document.getElementById('red_time');
							val = el.value;
							DopCom += el.id + "=" + el.value+ "_";
							el = document.getElementById('green_time_ws');
							val = el.value;
							DopCom += el.id + "=" + el.value+ "_";
							el = document.getElementById('yellow_time_ws');
							val = el.value;
							DopCom += el.id + "=" + el.value+ "_";
							el = document.getElementById('red_time_ws');
							val = el.value;
							DopCom += el.id + "=" + el.value+ "_";
					//alert(DopCom);
						</script>
				<tr class=trSubmitRow><td class=tdSubmitRow colspan=3></td></tr>
			</table>
		</td>
	</tr>
		<tr>
		<td class=tdCopyright>
			Ритейл АСП (+7(495)953-05-08, +7(495)951-68-09)
		</td>
		<td class=tdVersion>
			Версия 4.2.9
		</td>
	</tr>
</table>
 
</form>

<table width='100%' height='100%' id="message_box_1" style="height:100%;width:100%;position: absolute;left:0px;top:0px;display:none;z-index:998; background-image:url('halfpixel.png');">
<tr>
<td style="text-align:center;">
<div class="error_box" >
<table cellpadding=0 cellspacing=0 border=0 style="height:100%;width:100%;">
	<tr height='58px'>
		<td>
			<div style="border-bottom:solid 1px #f43839;height: 58px;background-color: #fccac1;width:100%;">
			<table cellpadding=0 cellspacing=0 border=0 style="height:100%;width:100%;">
				<tr>
					<td style="padding:9px;">
						<img src='error.gif' border=0/>
					</td>
					<td style="padding:9px; font-family: Arial, sans-serif;font-size:14pt;text-transform:uppercase;color:#f43839;text-align:center;">
						Внимание!
					</td>
					<td style="padding:9px;text-align:right;">
						<img src='close_error.gif' style="cursor:pointer;" onClick="close_salert(1); document.getElementById('message_box_1').style.display='none';" border=0/>
					</td>
					
				</tr>
			</table>
			</div>
		</td>
	</tr>
	<tr>
		<td style="padding:5px;vertical-align:top;" id="message_box_1_text">

		</td>
	</tr>
	<tr>
		<td style="padding:5px;vertical-align:top;" id="message_box_3_text">

		</td>
	</tr>
	<tr>
		<td>
		<div style="border-top:solid 1px #f43839;height: 38px;background-color: #fccac1;width:100%;text-align:center;">
			<input type="button" value="OK" onClick="close_salert(1); document.getElementById('message_box_1').style.display='none';" style="height:35px;width:80%;">
			</div>
		</td>
	</tr>
</table>
</div>
</td>
</tr>
</table>
<table width='100%' height='100%' id="message_box_2" style="height:100%;width:100%;position: absolute;left:0px;top:0px;display:none;z-index:997;background-image:url('halfpixel.png');">
<tr>
<td style="text-align:center;">
<div class="error_box" >
<table cellpadding=0 cellspacing=0 border=0 style="height:100%;width:100%;">
	<tr height='58px'>
		<td>
			<div style="border-bottom:solid 1px #f43839;height: 58px;background-color: #fccac1;width:100%;">
			<table cellpadding=0 cellspacing=0 border=0 style="height:100%;width:100%;">
				<tr>
					<td style="padding:9px;">
						<img src='error.gif' border=0/>
					</td>
					<td style="padding:9px; font-family: Arial, sans-serif;font-size:14pt;text-transform:uppercase;color:#f43839;text-align:center;">
						Внимание!
					</td>
					<td style="padding:9px;text-align:right;">
						<img src='close_error.gif' style="cursor:pointer;" onClick="close_salert(2); document.getElementById('message_box_2').style.display='none';" border=0/>
					</td>
				</tr>
			</table>
			</div>
		</td>
	</tr>
	<tr>
		<td style="padding:5px;vertical-align:top;" id="message_box_2_text">

		</td>
	</tr>
</table>
</div>
</td>
</tr>
</table>
<table width='100%' height='100%'  style="height:100%;width:100%;position: absolute;left:0px;top:0px;display:none;z-index:999;background-image:url('halfpixel.png');">
<tr>
<td style="text-align:center;">
<div class="error_box" >
<table cellpadding=0 cellspacing=0 border=0 style="height:100%;width:100%;">
	<tr height='58px'>
		<td>
			<div style="border-bottom:solid 1px #f43839;height: 58px;background-color: #fccac1;width:100%;">
			<table cellpadding=0 cellspacing=0 border=0 style="height:100%;width:100%;">
				<tr>
					<td style="padding:9px;">
						<img src='error.gif' border=0/>
					</td>
					<td style="padding:9px; font-family: Arial, sans-serif;font-size:14pt;text-transform:uppercase;color:#f43839;text-align:center;">
						Внимание!
					</td>
					<td style="padding:9px;text-align:right;">
						<img src='close_error.gif' style="cursor:pointer;" onClick="close_salert(3); document.getElementById('message_box_3').style.display='none';" border=0/>
					</td>
				</tr>
			</table>
			</div>
		</td>
	</tr>
	<tr>
		<td style="padding:5px;vertical-align:top;" id="message_box_3_text">

		</td>
	</tr>
</table>
</div>
</td>
</tr>
</table></body>
</html>
