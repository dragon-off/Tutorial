 
<html>
    <head>
        <title>Настройки времени</title>
        <LINK REL="StyleSheet" HREF="style.css" TYPE="text/css">
		<LINK REL="StyleSheet" HREF="style_messages.css" TYPE="text/css">
				<script type="text/javascript" src="/lib/ajax.js"></script>  		
		<script language='javascript'>
function PrintPage(val, ObjName)
{
 var PrintedDiv;
 PrintedDiv = document.getElementById(ObjName);
 PrintedDiv.innerHTML = '';
 AddHTMLAjax(PrintedDiv,val);
}
function DoScript(href)
{
 var PrintedDiv;
 PrintedDiv = document.getElementById("DopElement");
PrintedDiv.innerHTML = '';
 AddHTMLAjax(PrintedDiv,href);

} 
function close_salert(el)
{
var elem = parent.frames[0].document.getElementById('blockres');
elem.innerHTML=elem.innerHTML*1-1;
if(el==2) elem.innerHTML=0;
var messages = elem.innerHTML*1;
if(messages<0)
	{
	messages=0;
	elem.innerHTML=0;
	}
if(messages==0)
	parent.frames[0].document.getElementById('block').style.display = 'none';
parent.frames[1].document.getElementById('message_box_'+el+'_text').innerHTML="";
if(el==1)
	parent.frames[1].document.getElementById('message_box_3_text').innerHTML="";
}	


function createXMLHttpRequest() {
  try { return new XMLHttpRequest(); } catch(e) {}
  try { return new ActiveXObject('Msxml2.XMLHTTP'); } catch (e) {}
  try { return new ActiveXObject('Microsoft.XMLHTTP'); } catch (e) {}
  throw 'XMLHttpRequest not supported';
}

var HTTP_TIMEOUT = 10; // default to 20s
function httpRequest(url, onSuccess, onFail, postData, timeout) {

	var req = createXMLHttpRequest();
  var method = postData ? 'POST' : 'GET';
  req.open(method, url, true);
  req.setRequestHeader('User-Agent', 'XMLHTTP/1.0');
  if (postData) {
    req.setRequestHeader('Content-type','application/x-www-form-urlencoded');
  }

  var timer = null;
  if (!timeout) timeout = HTTP_TIMEOUT;
  if (timeout != -1) {
    timer = setTimeout(httpTimeoutClosure(req, onFail), timeout);
  }

  req.onreadystatechange = httpStatusChangeClosure(req, onSuccess, onFail, timer);
    req.send(postData);
}
  
function httpTimeoutClosure(req, onFail) {
  return function() {
   req.onreadystatechange = null;
    try {req.abort()}
   finally {if (onFail) onFail(req)}
  }
}

function httpStatusChangeClosure(req, onSuccess, onFail, timer) {
  return function() {
    if (req.readyState != 4) return;
    if (timer) clearTimeout(timer);
    if (req.status != 200 && req.status != 304) {
      if (onFail) onFail(req);
      return;
    }    
    if (onSuccess) onSuccess(req);
  }
}





function getVarValueFromURL(url, varName) { //для получение значений из URL
	var query = url.substring(url.indexOf('?') + 1);
	var vars = query.split("&");
	for (var i=0;i<vars.length;i++) {
		var pair = vars[i].split("=");
		if (pair[0] == varName) {
			return pair[1];
		}
	}
	return null;
} ;
function test_change() {
if(getVarValueFromURL(document.URL ,'change') == '1') {
httpRequest('/ca/update/set_suo_to_db.jsp', function(req) { }, function(req) {}, null, 3000);

};
};
		</script>
    </head> <body onload="test_change()">
<form method="GET" name="workstationInfo">
<input type="hidden" name="saveData" value="true">
   <div id="DopElement"></div>
 <%

 A=(${change}0)/10
 IF(A EQ 1)
 BEGIN
	A=(${recall_time}0)/10
 	IF(A GT 0)
	BEGIN
 		SETARRAY(500 A)
	
 	END
	B=(${second_time}0)/10
 	IF(B GT 0)
 		SETARRAY(501 B)
 	C=(${third_time}0)/20
 	IF(C GT 0)
 		SETARRAY(502 C)
 	N=(${mopenh_time}0)/10
 	IF(N GT 0)
 		SETARRAY(2700 N)
		N=0
	M=(${mopenm_time}0)/10
  		SETARRAY(2701 M)
		M=0
 	O=(${mcloseh_time}0)/10
 	IF(O GT 0)
 		SETARRAY(2702 O)
		O=0
 	K=(${mclosem_time}0)/10
 		SETARRAY(2703 K)
		K=0
 	N=(${topenh_time}0)/10
 	IF(N GT 0)
 		SETARRAY(2704 N)
		N=0
	M=(${topenm_time}0)/10
  		SETARRAY(2705 M)
		M=0
 	O=(${tcloseh_time}0)/10
 	IF(O GT 0)
 		SETARRAY(2706 O)
		O=0
 	K=(${tclosem_time}0)/10
 		SETARRAY(2707 K)
		K=0
	N=(${wopenh_time}0)/10
 	IF(N GT 0)
 		SETARRAY(2708 N)
		N=0
	M=(${wopenm_time}0)/10
  		SETARRAY(2709 M)
		M=0
 	O=(${wcloseh_time}0)/10
 	IF(O GT 0)
 		SETARRAY(2710 O)
		O=0
 	K=(${wclosem_time}0)/10
 		SETARRAY(2711 K)
		K=0
	N=(${thopenh_time}0)/10
 	IF(N GT 0)
 		SETARRAY(2712 N)
		N=0
	M=(${thopenm_time}0)/10
  		SETARRAY(2713 M)
		M=0
 	O=(${thcloseh_time}0)/10
 	IF(O GT 0)
 		SETARRAY(2714 O)
		O=0
 	K=(${thclosem_time}0)/10
 		SETARRAY(2715 K)
		K=0
	N=(${fopenh_time}0)/10
 	IF(N GT 0)
 		SETARRAY(2716 N)
		N=0
	M=(${fopenm_time}0)/10
  		SETARRAY(2717 M)
		M=0
 	O=(${fcloseh_time}0)/10
 	IF(O GT 0)
 		SETARRAY(2718 O)
		O=0
 	K=(${fclosem_time}0)/10
 		SETARRAY(2719 K)
		K=0
	N=(${satopenh_time}0)/10
 	IF(N GT 0)
 		SETARRAY(2720 N)
		N=0
	M=(${satopenm_time}0)/10
  		SETARRAY(2721 M)
		M=0
 	O=(${satcloseh_time}0)/10
 	IF(O GT 0)
 		SETARRAY(2722 O)
		O=0
 	K=(${satclosem_time}0)/10
 		SETARRAY(2723 K)
		K=0
	N=(${sunopenh_time}0)/10
 	IF(N GT 0)
 		SETARRAY(2724 N)
		N=0
	M=(${sunopenm_time}0)/10
  		SETARRAY(2725 M)
		M=0
 	O=(${suncloseh_time}0)/10
 	IF(O GT 0)
 		SETARRAY(2726 O)
		O=0
 	K=(${sunclosem_time}0)/10
 		SETARRAY(2727 K)
		K=0	
	L=(${porog_time}0)/10
 	IF(L GT 0) BEGIN
 		W=(L*60)/2
		SETARRAY(791 W)
 	END
 	J=(${otlog_time}0)/20
 	IF(J GT 0)
 		SETARRAY(507 J)
 	P=(${pereriv_time}0)/10
 	IF(P GT 0)
 		SETARRAY(508 P*60)
 

END
 
 %>
<table class=tableMain cellpadding=5 cellspacing=0>
	<tr>
		<td class=headerBar align=left colspan=2>
			Настройки времени
		</td>
	</tr>
	<tr>
		<td colspan=2>
			<table class=tableSection cellpadding=0 cellspacing=0 align=center>
				<tr>
					<td nowrap class=tdHeaderSection>Время </td>
					<td nowrap class=tdHeaderSection colspan=2>Значение</td>
				</tr>
 <tr><td colspan=3><hr></td></tr>
				<tr>
					<td nowrap class=tdDataRow>Время на установку оценки СОКОК</td>
					<td nowrap class=tdDataRowC><input type="input" name="chered" value="<% ARRAY(509)  %>" size="7"></td>
					<td nowrap class=tdDataRowL>секунд</td>
				</tr>
				<input type="HIDDEN" name="change" value="1" size="7">
								<tr>
					<td nowrap class=tdDataRow>Доступность кнопки "Повторный вызов"</td>
					<td nowrap class=tdDataRowC><input type="input" name="recall_time" value="<% ARRAY(500) %>" size="7"></td>
					<td nowrap class=tdDataRowL>секунд</td>
				</tr>			
				<tr>
					<td nowrap class=tdDataRow>Время сброса клиента</td>
					<td nowrap class=tdDataRowC><input type="input" name="second_time" value="<% ARRAY(501) %>" size="7"></td>
					<td nowrap class=tdDataRowL>секунд</td>
				</tr>
				
					<td nowrap class=tdDataRow>Максимальное время перерыва</td>
					<td nowrap class=tdDataRowC><input type="input" name="pereriv_time" value="<% ARRAY(508)/60 %>" size="7"></td>
					<td nowrap class=tdDataRowL>минут</td>
				</tr>
			
				<tr><td colspan=3><hr></td></tr>
				
				
				
				<tr border=0 >
					<td class=headerBar align=left colspan=3>Настройка расписания работы офиса</td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow colspan=3>Понедельник</td><td></td><td></td>
				</tr>
				<tr border=0>
					<td border=0 nowrap class=tdDataRow>Время начала работы офиса</td>
					<td border=0 nowrap class=tdDataRowC><input type="input" name="mopenh_time" value="<% ARRAY(2700) %>" size="2">ч.</td>
					<td border=0 nowrap class=tdDataRowC><input type="input" name="mopenm_time" value="<% ARRAY(2701) %>" size="2">мин.</td>
				</tr>
				<tr border=0>
					<td border=0 nowrap class=tdDataRow>Время окончания работы офиса<hr></td>
					<td border=0 nowrap class=tdDataRowC><input type="input" name="mcloseh_time" value="<% ARRAY(2702) %>" size="2">ч.</td>
					<td border=0 nowrap class=tdDataRowC><input type="input" name="mclosem_time" value="<% ARRAY(2703) %>" size="2">мин.</td>
				</tr>
				<tr>
					<td colspan=3></td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow colspan=3>Вторник </td><td></td><td></td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow>Время начала работы офиса</td>
					<td nowrap class=tdDataRowC><input type="input" name="topenh_time" value="<% ARRAY(2704) %>" size="2">ч.</td>
					<td nowrap class=tdDataRowC><input type="input" name="topenm_time" value="<% ARRAY(2705) %>" size="2">мин.</td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow>Время окончания работы офиса<hr></td>
					<td nowrap class=tdDataRowC><input type="input" name="tcloseh_time" value="<% ARRAY(2706) %>" size="2">ч.</td>
					<td nowrap class=tdDataRowC><input type="input" name="tclosem_time" value="<% ARRAY(2707) %>" size="2">мин.</td>
				</tr>
				<tr>
					<td colspan=3></td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow colspan=3>Среда </td><td></td><td></td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow>Время начала работы офиса</td>
					<td nowrap class=tdDataRowC><input type="input" name="wopenh_time" value="<% ARRAY(2708) %>" size="2">ч.</td>
					<td nowrap class=tdDataRowC><input type="input" name="wopenm_time" value="<% ARRAY(2709) %>" size="2">мин.</td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow>Время окончания работы офиса<hr></td>
					<td nowrap class=tdDataRowC><input type="input" name="wcloseh_time" value="<% ARRAY(2710) %>" size="2">ч.</td>
					<td nowrap class=tdDataRowC><input type="input" name="wclosem_time" value="<% ARRAY(2711) %>" size="2">мин.</td>
				</tr>
				<tr>
					<td colspan=3></td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow colspan=3>Четверг </td><td></td><td></td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow>Время начала работы офиса</td>
					<td nowrap class=tdDataRowC><input type="input" name="thopenh_time" value="<% ARRAY(2712) %>" size="2">ч.</td>
					<td nowrap class=tdDataRowC><input type="input" name="thopenm_time" value="<% ARRAY(2713) %>" size="2">мин.</td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow>Время окончания работы офиса<hr></td>
					<td nowrap class=tdDataRowC><input type="input" name="thcloseh_time" value="<% ARRAY(2714) %>" size="2">ч.</td>
					<td nowrap class=tdDataRowC><input type="input" name="thclosem_time" value="<% ARRAY(2715) %>" size="2">мин.</td>
				</tr>
				<tr>
					<td colspan=3></td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow colspan=3>Пятница</td><td></td><td></td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow>Время начала работы офиса</td>
					<td nowrap class=tdDataRowC><input type="input" name="fopenh_time" value="<% ARRAY(2716) %>" size="2">ч.</td>
					<td nowrap class=tdDataRowC><input type="input" name="fopenm_time" value="<% ARRAY(2717) %>" size="2">мин.</td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow>Время окончания работы офиса <hr></td>
					<td nowrap class=tdDataRowC><input type="input" name="fcloseh_time" value="<% ARRAY(2718) %>" size="2">ч.</td>
					<td nowrap class=tdDataRowC><input type="input" name="fclosem_time" value="<% ARRAY(2719) %>" size="2">мин.</td>
				</tr>
				<tr>
					<td colspan=3></td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow colspan=3>Суббота </td><td></td><td></td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow>Время начала работы офиса</td>
					<td nowrap class=tdDataRowC><input type="input" name="satopenh_time" value="<% ARRAY(2720) %>" size="2">ч.</td>
					<td nowrap class=tdDataRowC><input type="input" name="satopenm_time" value="<% ARRAY(2721) %>" size="2">мин.</td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow>Время окончания работы офиса<hr></td>
					<td nowrap class=tdDataRowC><input type="input" name="satcloseh_time" value="<% ARRAY(2722) %>" size="2">ч.</td>
					<td nowrap class=tdDataRowC><input type="input" name="satclosem_time" value="<% ARRAY(2723) %>" size="2">мин.</td>
				</tr>
				<tr>
					<td colspan=3></td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow colspan=3>Воскресенье </td><td></td><td></td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow>Время начала работы офиса</td>
					<td nowrap class=tdDataRowC><input type="input" name="sunopenh_time" value="<% ARRAY(2724) %>" size="2">ч.</td>
					<td nowrap class=tdDataRowC><input type="input" name="sunopenm_time" value="<% ARRAY(2725) %>" size="2">мин.</td>
				</tr>
				<tr>
					<td nowrap class=tdDataRow>Время окончания работы офиса<hr></td>
					<td nowrap class=tdDataRowC><input type="input" name="suncloseh_time" value="<% ARRAY(2726) %>" size="2">ч.</td>
					<td nowrap class=tdDataRowC><input type="input" name="sunclosem_time" value="<% ARRAY(2727) %>" size="2">мин.</td>
				</tr>
				
				
				
				
					
						
				<tr class=trSubmitRow><td class=tdSubmitRow colspan=3><input onClick="javascript:DoScript('/lib/1.jsp?TypeId=6&ComIndex=19&Comment=0');alert('Изменения были сохранены');"onmouseover="javascript:this.className='submitOver';" onmouseout="javascript:this.className='submitOut';" type=submit value=Сохранить></td></tr>
			</table>
		</td>
	</tr>
		<tr>
		<td class=tdCopyright>
			Ритейл АСП (+7(495)953-05-08, +7(495)951-68-09)
		</td>
		<td class=tdVersion>
			Версия 4.2.9
		</td>
	</tr>
</table>
 
</form>

<table width='100%' height='100%' id="message_box_1" style="height:100%;width:100%;position: absolute;left:0px;top:0px;display:none;z-index:998; background-image:url('halfpixel.png');">
<tr>
<td style="text-align:center;">
<div class="error_box" >
<table cellpadding=0 cellspacing=0 border=0 style="height:100%;width:100%;">
	<tr height='58px'>
		<td>
			<div style="border-bottom:solid 1px #f43839;height: 58px;background-color: #fccac1;width:100%;">
			<table cellpadding=0 cellspacing=0 border=0 style="height:100%;width:100%;">
				<tr>
					<td style="padding:9px;">
						<img src='error.gif' border=0/>
					</td>
					<td style="padding:9px; font-family: Arial, sans-serif;font-size:14pt;text-transform:uppercase;color:#f43839;text-align:center;">
						Внимание!
					</td>
					<td style="padding:9px;text-align:right;">
						<img src='close_error.gif' style="cursor:pointer;" onClick="close_salert(1); document.getElementById('message_box_1').style.display='none';" border=0/>
					</td>
					
				</tr>
			</table>
			</div>
		</td>
	</tr>
	<tr>
		<td style="padding:5px;vertical-align:top;" id="message_box_1_text">

		</td>
	</tr>
	<tr>
		<td style="padding:5px;vertical-align:top;" id="message_box_3_text">

		</td>
	</tr>
	<tr>
		<td>
		<div style="border-top:solid 1px #f43839;height: 38px;background-color: #fccac1;width:100%;text-align:center;">
			<input type="button" value="OK" onClick="close_salert(1); document.getElementById('message_box_1').style.display='none';" style="height:35px;width:80%;">
			</div>
		</td>
	</tr>
</table>
</div>
</td>
</tr>
</table>
<table width='100%' height='100%' id="message_box_2" style="height:100%;width:100%;position: absolute;left:0px;top:0px;display:none;z-index:997;background-image:url('halfpixel.png');">
<tr>
<td style="text-align:center;">
<div class="error_box" >
<table cellpadding=0 cellspacing=0 border=0 style="height:100%;width:100%;">
	<tr height='58px'>
		<td>
			<div style="border-bottom:solid 1px #f43839;height: 58px;background-color: #fccac1;width:100%;">
			<table cellpadding=0 cellspacing=0 border=0 style="height:100%;width:100%;">
				<tr>
					<td style="padding:9px;">
						<img src='error.gif' border=0/>
					</td>
					<td style="padding:9px; font-family: Arial, sans-serif;font-size:14pt;text-transform:uppercase;color:#f43839;text-align:center;">
						Внимание!
					</td>
					<td style="padding:9px;text-align:right;">
						<img src='close_error.gif' style="cursor:pointer;" onClick="close_salert(2); document.getElementById('message_box_2').style.display='none';" border=0/>
					</td>
				</tr>
			</table>
			</div>
		</td>
	</tr>
	<tr>
		<td style="padding:5px;vertical-align:top;" id="message_box_2_text">

		</td>
	</tr>
</table>
</div>
</td>
</tr>
</table>
<table width='100%' height='100%'  style="height:100%;width:100%;position: absolute;left:0px;top:0px;display:none;z-index:999;background-image:url('halfpixel.png');">
<tr>
<td style="text-align:center;">
<div class="error_box" >
<table cellpadding=0 cellspacing=0 border=0 style="height:100%;width:100%;">
	<tr height='58px'>
		<td>
			<div style="border-bottom:solid 1px #f43839;height: 58px;background-color: #fccac1;width:100%;">
			<table cellpadding=0 cellspacing=0 border=0 style="height:100%;width:100%;">
				<tr>
					<td style="padding:9px;">
						<img src='error.gif' border=0/>
					</td>
					<td style="padding:9px; font-family: Arial, sans-serif;font-size:14pt;text-transform:uppercase;color:#f43839;text-align:center;">
						Внимание!
					</td>
					<td style="padding:9px;text-align:right;">
						<img src='close_error.gif' style="cursor:pointer;" onClick="close_salert(3); document.getElementById('message_box_3').style.display='none';" border=0/>
					</td>
				</tr>
			</table>
			</div>
		</td>
	</tr>
	<tr>
		<td style="padding:5px;vertical-align:top;" id="message_box_3_text">

		</td>
	</tr>
</table>
</div>
</td>
</tr>
</table></body>
</html>
